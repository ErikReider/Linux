# Function to source files if they exist
function zsh_add_file() {
    [ -f "$ZDOTDIR/$1" ] && source "$ZDOTDIR/$1"
}

function zsh_add_plugin() {
    PLUGIN_NAME=$(echo $1 | cut -d "/" -f 2)
    if [ -d "$ZDOTDIR/plugins/$PLUGIN_NAME" ]; then
        # For plugins
        zsh_add_file "plugins/$PLUGIN_NAME/$PLUGIN_NAME.plugin.zsh" \
            || zsh_add_file "plugins/$PLUGIN_NAME/$PLUGIN_NAME.zsh"

        # Source their config file
        if [ -f "$ZDOTDIR/plugin-conf/$PLUGIN_NAME" ]; then
            zsh_add_file "plugin-conf/$PLUGIN_NAME"
        fi
    else
        echo "Failed to find $PLUGIN_NAME in $ZDOTDIR!..."
    fi
}

function mkcd {
    mkdir $1
    cd $1
}

function tag_release {
    if [ "$1" = "" ]; then
        echo "Usage: tag_release TAG_NAME. Example: v0.6.2"
    else
        # Check if any previous tags exist
        if [[ $(git rev-parse --tags | wc -l) != 0 ]]; then
            str=$(git tag -l --sort=taggerdate | tail -1)..HEAD
        fi
        git shortlog $str | git tag -a "$1" -F -
    fi
}

function git_todays_changelog {
    if $(git rev-parse); then
        git --no-pager shortlog --since "yesterday" --until "today" --all --show-pulls
    fi
}

function man_preview {
    if [[ -f $1 ]]; then
        tmpPath=/tmp/$(basename $1).roff.tmp
        scdoc <$1 >$tmpPath && man -l $tmpPath
        rm -rf $tmpPath
    else
        echo "Man file doesn't exist..."
    fi
}
